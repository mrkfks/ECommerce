@model List<Dashboard.Web.Models.CompanyVm>
@{
    ViewData["Title"] = "Şirketler";
}
<div class="d-flex align-items-center justify-content-between mb-3">
    <h4 class="m-0">Şirketler</h4>
    <div class="d-flex align-items-center gap-2">
        <a asp-action="Create" class="btn btn-primary btn-sm">
            <i class="fa-solid fa-plus me-2"></i>Yeni Şirket Ekle
        </a>
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success py-1 px-2 mb-0">@TempData["Success"]</div>
        }
        @if (TempData["Error"] != null)
        {
            <div class="alert alert-danger py-1 px-2 mb-0">@TempData["Error"]</div>
        }
    </div>
</div>
<div class="card">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-striped align-middle m-0">
        <thead>
          <tr>
            <th>#</th>
            <th>Logo</th>
            <th>Ad</th>
            <th>Domain</th>
            <th>Email</th>
            <th>Onay</th>
            <th>Durum</th>
            <th class="text-end">İşlemler</th>
          </tr>
        </thead>
        <tbody>
        @if (Model != null && Model.Any())
        {
            int i = 1;
            foreach (var c in Model)
            {
                <tr>
                    <td>@i</td>
                    <td>
                        @if (!string.IsNullOrEmpty(c.LogoUrl))
                        {
                            <img src="@c.LogoUrl" alt="Logo" style="height: 32px; max-width: 60px; object-fit: contain;" />
                        }
                        else
                        {
                            <span class="badge bg-light text-muted"><i class="fa-solid fa-building"></i></span>
                        }
                    </td>
                    <td>
                        <div class="d-flex align-items-center gap-2">
                            @if (!string.IsNullOrEmpty(c.PrimaryColor))
                            {
                                <span class="rounded" style="width: 12px; height: 12px; background-color: @c.PrimaryColor; display: inline-block;"></span>
                            }
                            @c.Name
                        </div>
                    </td>
                    <td>
                        @if (!string.IsNullOrEmpty(c.Domain))
                        {
                            <code class="small">@c.Domain</code>
                        }
                        else
                        {
                            <span class="text-muted small">—</span>
                        }
                    </td>
                    <td>@c.Email</td>
                    <td>
                        @if (c.IsApproved)
                        { <span class="badge text-bg-success">Onaylı</span> }
                        else
                        { <span class="badge text-bg-warning">Bekliyor</span> }
                    </td>
                    <td>
                        @if (c.IsActive)
                        { <span class="badge text-bg-primary">Aktif</span> }
                        else
                        { <span class="badge text-bg-secondary">Pasif</span> }
                    </td>
                    <td class="text-end">
                        <div class="btn-group btn-group-sm" role="group">
                            <a asp-action="Details" asp-route-id="@c.Id" class="btn btn-info" title="Detay">
                                <i class="fa-solid fa-eye"></i>
                            </a>
                            <a asp-action="Edit" asp-route-id="@c.Id" class="btn btn-warning" title="Düzenle">
                                <i class="fa-solid fa-edit"></i>
                            </a>
                            <a asp-action="Branding" asp-route-id="@c.Id" class="btn btn-primary" title="Marka Ayarları">
                                <i class="fa-solid fa-palette"></i>
                            </a>
                        </div>
                        <div class="btn-group btn-group-sm ms-2" role="group">
                            @if (!c.IsApproved)
                            {
                                <form asp-action="Approve" asp-controller="Company" method="post" class="d-inline">
                                    <input type="hidden" name="id" value="@c.Id" />
                                    <button type="submit" class="btn btn-success" title="Onayla">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                </form>
                            }
                            @if (c.IsActive)
                            {
                                <form asp-action="Deactivate" asp-controller="Company" method="post" class="d-inline">
                                    <input type="hidden" name="id" value="@c.Id" />
                                    <button type="submit" class="btn btn-outline-danger" title="Pasifleştir">
                                        <i class="fa-solid fa-ban"></i>
                                    </button>
                                </form>
                            }
                            else
                            {
                                <form asp-action="Activate" asp-controller="Company" method="post" class="d-inline">
                                    <input type="hidden" name="id" value="@c.Id" />
                                    <button type="submit" class="btn btn-outline-success" title="Aktif Yap">
                                        <i class="fa-solid fa-power-off"></i>
                                    </button>
                                </form>
                            }
                        </div>
                    </td>
                </tr>
                i++;
            }
        }
        else
        {
            <tr><td colspan="8" class="text-center py-4 text-muted">Kayıt bulunamadı</td></tr>
        }
        </tbody>
      </table>
    </div>
  </div>
</div>
