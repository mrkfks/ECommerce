@model List<Dashboard.Web.Models.CompanyVm>
@{
    ViewData["Title"] = "Şirketler";
}
<div class="d-flex align-items-center justify-content-between mb-3">
    <h4 class="m-0">Şirketler</h4>
    <div class="d-flex align-items-center gap-2">
        <a asp-action="Create" class="btn btn-primary btn-sm">
            <i class="fa-solid fa-plus me-2"></i>Yeni Şirket Ekle
        </a>
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success py-1 px-2 mb-0">@TempData["Success"]</div>
        }
        @if (TempData["Error"] != null)
        {
            <div class="alert alert-danger py-1 px-2 mb-0">@TempData["Error"]</div>
        }
    </div>
</div>
<div class="card">
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-striped align-middle m-0">
        <thead>
          <tr>
            <th>#</th>
            <th>Ad</th>
            <th>Email</th>
            <th>Vergi No</th>
            <th>Onay</th>
            <th>Durum</th>
            <th class="text-end">İşlemler</th>
          </tr>
        </thead>
        <tbody>
        @if (Model != null && Model.Any())
        {
            int i = 1;
            foreach (var c in Model)
            {
                <tr>
                    <td>@i</td>
                    <td>@c.Name</td>
                    <td>@c.Email</td>
                    <td>@c.TaxNumber</td>
                    <td>
                        @if (c.IsApproved)
                        { <span class="badge text-bg-success">Onaylı</span> }
                        else
                        { <span class="badge text-bg-warning">Bekliyor</span> }
                    </td>
                    <td>
                        @if (c.IsActive)
                        { <span class="badge text-bg-primary">Aktif</span> }
                        else
                        { <span class="badge text-bg-secondary">Pasif</span> }
                    </td>
                    <td class="text-end">
                        <a asp-action="Details" asp-route-id="@c.Id" class="btn btn-sm btn-info me-1">
                            <i class="fa-solid fa-eye me-1"></i> Detay
                        </a>
                        <a asp-action="Edit" asp-route-id="@c.Id" class="btn btn-sm btn-warning me-1">
                            <i class="fa-solid fa-edit me-1"></i> Düzenle
                        </a>
                        <form asp-action="Approve" asp-controller="Company" method="post" class="d-inline">
                            <input type="hidden" name="id" value="@c.Id" />
                            <button type="submit" class="btn btn-sm btn-success" @(c.IsApproved ? "disabled" : null)>
                                <i class="fa-solid fa-check me-1"></i> Onayla
                            </button>
                        </form>
                        @if (c.IsActive)
                        {
                            <form asp-action="Deactivate" asp-controller="Company" method="post" class="d-inline ms-1">
                                <input type="hidden" name="id" value="@c.Id" />
                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                    <i class="fa-solid fa-ban me-1"></i> Pasifleştir
                                </button>
                            </form>
                        }
                        else
                        {
                            <form asp-action="Activate" asp-controller="Company" method="post" class="d-inline ms-1">
                                <input type="hidden" name="id" value="@c.Id" />
                                <button type="submit" class="btn btn-sm btn-outline-success">
                                    <i class="fa-solid fa-power-off me-1"></i> Aktif Yap
                                </button>
                            </form>
                        }
                    </td>
                </tr>
                i++;
            }
        }
        else
        {
            <tr><td colspan="7" class="text-center py-4 text-muted">Kayıt bulunamadı</td></tr>
        }
        </tbody>
      </table>
    </div>
  </div>
</div>
