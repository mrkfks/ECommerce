<div class="profile-page py-4">
  <div class="container">
    <h2 class="fw-bold mb-4"><i class="bi bi-person-circle me-2"></i>Hesabım</h2>

    <div class="row">
      <!-- Sol Menü -->
      <div class="col-md-3 mb-4">
        <div class="card shadow-sm">
          <div class="card-body text-center py-4">
            <div class="avatar-circle bg-primary text-white mx-auto mb-3">
              <i class="bi bi-person fs-1"></i>
            </div>
            <h5 class="mb-1">{{ user?.firstName }} {{ user?.lastName }}</h5>
            <p class="text-muted small mb-0">{{ user?.email }}</p>
          </div>
          <div class="list-group list-group-flush">
            <button class="list-group-item list-group-item-action" 
                    [class.active]="activeTab === 'profile'" 
                    (click)="activeTab = 'profile'">
              <i class="bi bi-person me-2"></i>Profil Bilgileri
            </button>
            <button class="list-group-item list-group-item-action" 
                    [class.active]="activeTab === 'security'" 
                    (click)="activeTab = 'security'">
              <i class="bi bi-shield-lock me-2"></i>Güvenlik
            </button>
            <a routerLink="/orders" class="list-group-item list-group-item-action">
              <i class="bi bi-box me-2"></i>Siparişlerim
            </a>
            <button class="list-group-item list-group-item-action text-danger" (click)="logout()">
              <i class="bi bi-box-arrow-right me-2"></i>Çıkış Yap
            </button>
          </div>
        </div>
      </div>

      <!-- İçerik -->
      <div class="col-md-9">
        <!-- Profil Tabı -->
        @if (activeTab === 'profile') {
          <div class="card shadow-sm">
            <div class="card-header bg-white d-flex justify-content-between align-items-center">
              <h5 class="mb-0">Profil Bilgileri</h5>
              <button class="btn btn-sm" [ngClass]="isEditing ? 'btn-outline-secondary' : 'btn-outline-primary'" 
                      (click)="toggleEdit()">
                <i class="bi" [ngClass]="isEditing ? 'bi-x' : 'bi-pencil'"></i>
                {{ isEditing ? 'İptal' : 'Düzenle' }}
              </button>
            </div>
            <div class="card-body">
              @if (isEditing) {
                <form (ngSubmit)="saveProfile()">
                  <div class="row g-3">
                    <div class="col-md-6">
                      <label class="form-label">Ad</label>
                      <input type="text" class="form-control" id="firstName" name="firstName" [(ngModel)]="editForm.firstName">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Soyad</label>
                      <input type="text" class="form-control" id="lastName" name="lastName" [(ngModel)]="editForm.lastName">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">E-posta</label>
                      <input type="email" class="form-control" id="email" name="email" [(ngModel)]="editForm.email">
                    </div>
                    <div class="col-md-6">
                      <label class="form-label">Telefon</label>
                      <input type="tel" class="form-control" id="phone" name="phone" [(ngModel)]="editForm.phone" 
                             placeholder="0555 555 55 55">
                    </div>
                    <div class="col-12">
                      <button type="submit" class="btn btn-primary" [disabled]="isSaving">
                        @if (isSaving) {
                          <span class="spinner-border spinner-border-sm me-2"></span>Kaydediliyor...
                        } @else {
                          <i class="bi bi-check me-2"></i>Kaydet
                        }
                      </button>
                    </div>
                  </div>
                </form>
              } @else {
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label text-muted small mb-1">Ad</label>
                    <p class="mb-0 fw-medium">{{ user?.firstName }}</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label text-muted small mb-1">Soyad</label>
                    <p class="mb-0 fw-medium">{{ user?.lastName }}</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label text-muted small mb-1">E-posta</label>
                    <p class="mb-0 fw-medium">{{ user?.email }}</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label text-muted small mb-1">Telefon</label>
                    <p class="mb-0 fw-medium text-muted">Belirtilmemiş</p>
                  </div>
                </div>
              }
            </div>
          </div>
        }

        <!-- Güvenlik Tabı -->
        @if (activeTab === 'security') {
          <div class="card shadow-sm">
            <div class="card-header bg-white">
              <h5 class="mb-0">Şifre Değiştir</h5>
            </div>
            <div class="card-body">
              <form (ngSubmit)="changePassword()">
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label">Mevcut Şifre</label>
                    <input type="password" class="form-control" id="currentPassword" name="currentPassword" [(ngModel)]="passwordForm.currentPassword" required>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Yeni Şifre</label>
                    <input type="password" class="form-control" id="newPassword" name="newPassword" [(ngModel)]="passwordForm.newPassword" required>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Yeni Şifre (Tekrar)</label>
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" [(ngModel)]="passwordForm.confirmPassword" required>
                  </div>
                  <div class="col-12">
                    <button type="submit" class="btn btn-primary">
                      <i class="bi bi-shield-check me-2"></i>Şifreyi Değiştir
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        }
      </div>
    </div>
  </div>
</div>
